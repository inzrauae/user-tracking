# ğŸ¯ System Architecture & Flow Diagrams

## Overall System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER BROWSERS / DEVICES                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Device A              Device B              Device C           â”‚
â”‚  Desktop               Desktop               Mobile             â”‚
â”‚  Chrome                Firefox               Safari             â”‚
â”‚  â†“                     â†“                     â†“                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                        FRONTEND (React)
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   App.tsx           â”‚
                    â”‚ - Login Screen      â”‚
                    â”‚ - Dashboard         â”‚
                    â”‚ - Notifications     â”‚
                    â”‚ - Session Manager   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                        HTTP/REST API
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      BACKEND (Node.js/Express)           â”‚
        â”‚                                          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Auth Routes (Enhanced)            â”‚ â”‚
        â”‚  â”‚ - Login (with session mgmt)        â”‚ â”‚
        â”‚  â”‚ - Logout                           â”‚ â”‚
        â”‚  â”‚ - Sessions list                    â”‚ â”‚
        â”‚  â”‚ - Device logout                    â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Notification Routes               â”‚ â”‚
        â”‚  â”‚ - Get notifications                â”‚ â”‚
        â”‚  â”‚ - Mark as read                     â”‚ â”‚
        â”‚  â”‚ - Delete                           â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Middleware                        â”‚ â”‚
        â”‚  â”‚ - Auth validation (async)          â”‚ â”‚
        â”‚  â”‚ - Session validation               â”‚ â”‚
        â”‚  â”‚ - Activity tracking                â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Utilities                         â”‚ â”‚
        â”‚  â”‚ - Device fingerprinting            â”‚ â”‚
        â”‚  â”‚ - Mobile detection                 â”‚ â”‚
        â”‚  â”‚ - IP extraction                    â”‚ â”‚
        â”‚  â”‚ - UA parsing                       â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     DATABASE (MySQL/Sequelize)           â”‚
        â”‚                                          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Users                             â”‚ â”‚
        â”‚  â”‚  - id, email, password (hashed)    â”‚ â”‚
        â”‚  â”‚  - role, mobile, isOnline          â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  ActiveSessions                    â”‚ â”‚
        â”‚  â”‚  - sessionId, deviceId             â”‚ â”‚
        â”‚  â”‚  - browser, os, device type        â”‚ â”‚
        â”‚  â”‚  - ipAddress, login/activity time  â”‚ â”‚
        â”‚  â”‚  - status (ACTIVE/INVALIDATED)     â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  LoginAttempts                     â”‚ â”‚
        â”‚  â”‚  - email, password (none)          â”‚ â”‚
        â”‚  â”‚  - success, failure reason         â”‚ â”‚
        â”‚  â”‚  - ip, device id, user agent       â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚  Notifications                     â”‚ â”‚
        â”‚  â”‚  - type, title, message            â”‚ â”‚
        â”‚  â”‚  - priority, isRead                â”‚ â”‚
        â”‚  â”‚  - relatedData (JSON)              â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Login Flow Sequence Diagram

```
User (Device A)          Frontend              Backend              Database
    â”‚                      â”‚                      â”‚                    â”‚
    â”‚  "Login Form"        â”‚                      â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                      â”‚                    â”‚
    â”‚                      â”‚ email + password     â”‚                    â”‚
    â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                    â”‚
    â”‚                      â”‚                      â”‚ Detect Device      â”‚
    â”‚                      â”‚                      â”‚ (UA + IP)          â”‚
    â”‚                      â”‚                      â”‚ Generate SHA256    â”‚
    â”‚                      â”‚                      â”‚ fingerprint        â”‚
    â”‚                      â”‚                      â”‚ Check Mobile?      â”‚
    â”‚                      â”‚                      â”‚ â”œâ”€â†’ YESâ†’401+403 âœ—  â”‚
    â”‚                      â”‚                      â”‚ â””â”€â†’ NOâ†’Continue    â”‚
    â”‚                      â”‚                      â”‚                    â”‚
    â”‚                      â”‚                      â”‚ Hash Password      â”‚
    â”‚                      â”‚                      â”‚ Verify             â”‚
    â”‚                      â”‚                      â”‚ â”œâ”€â†’ FAILâ†’Log+401 âœ— â”‚
    â”‚                      â”‚                      â”‚ â””â”€â†’ OKâ†’Continue    â”‚
    â”‚                      â”‚                      â”‚                    â”‚
    â”‚                      â”‚                      â”‚ Check Active       â”‚
    â”‚                      â”‚                      â”‚ Sessions           â”‚
    â”‚                      â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ SELECT...
    â”‚                      â”‚                      â”‚â† Session found â”€â”€â”‚
    â”‚                      â”‚                      â”‚ Different Device? â”‚
    â”‚                      â”‚                      â”‚ â”œâ”€â†’ YESâ†’Invalidateâ”‚
    â”‚                      â”‚                      â”‚ â”‚  â”œâ”€â”€â†’Update â”€â†’â”‚ UPDATE...
    â”‚                      â”‚                      â”‚ â”‚  â”œâ”€â”€â†’Notify â”€â”€â†’ INSERT...
    â”‚                      â”‚                      â”‚ â””â”€â†’ NOâ†’Continue  â”‚
    â”‚                      â”‚                      â”‚                   â”‚
    â”‚                      â”‚                      â”‚ Create Session    â”‚
    â”‚                      â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ INSERT...
    â”‚                      â”‚                      â”‚ Create Attempt    â”‚
    â”‚                      â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ INSERT...
    â”‚                      â”‚                      â”‚ Gen JWT Token     â”‚
    â”‚                      â”‚                      â”‚ Update isOnline   â”‚
    â”‚                      â”‚                      â”‚ {success, user,   â”‚
    â”‚                      â”‚    token, sessionId, â”‚ deviceInfo}       â”‚
    â”‚                      â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
    â”‚  Store localStorage  â”‚                      â”‚                   â”‚
    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                   â”‚
    â”‚                      â”‚                      â”‚                   â”‚
    â–¼                      â–¼                      â–¼                    â–¼

Legend: â”€â†’ Request  â†â”€ Response  âœ— Error
```

## Multi-Device Detection Flow

```
User (Same Email)

Device A (Desktop)          Device B (Mobile)         Server DB
    â”‚                           â”‚                        â”‚
    â”‚ 1. Login from A           â”‚                        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚                        â”‚
    â”‚                           â”‚                        â”‚
    â”‚                           â”‚                        â”‚ Find sessions
    â”‚                           â”‚                        â”‚ for this user
    â”‚                           â”‚                        â”œâ†’ Session A found
    â”‚                           â”‚                        â”‚
    â”‚                           â”‚ 2. Login from B        â”‚
    â”‚                           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚
    â”‚                           â”‚                        â”‚ Find sessions
    â”‚                           â”‚                        â”œâ†’ Session A exists
    â”‚                           â”‚                        â”‚ Device IDs differ!
    â”‚                           â”‚                        â”‚ Invalidate A
    â”‚                           â”‚                        â”‚ Create B
    â”‚                           â”‚                        â”‚ Notify Admin
    â”‚                           â”‚â†â”€â”€Successâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
    â”‚                           â”‚  (session B active)    â”‚
    â”‚                           â”‚                        â”‚
    â”‚ 3. Refresh Page           â”‚                        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚                        â”‚
    â”‚                           â”‚                        â”‚ Check Session A
    â”‚                           â”‚                        â”œâ†’ Status=INVALIDATED
    â”‚â†â”€â”€Logout (401)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
    â”‚ (Re-login needed)         â”‚                        â”‚
    â”‚                           â”‚                        â”‚
    â–¼                           â–¼                        â–¼

Result: Device A logged out, Device B logged in âœ“
```

## Mobile Restriction Flow

```
User (Mobile Device)

Mobile Device              Frontend           Backend              Notification
    â”‚                        â”‚                   â”‚                    â”‚
    â”‚ "Login"                â”‚                   â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                   â”‚                    â”‚
    â”‚                        â”‚ email + password  â”‚                    â”‚
    â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                    â”‚
    â”‚                        â”‚                   â”‚ Detect Mobile      â”‚
    â”‚                        â”‚                   â”‚ (User-Agent)       â”‚
    â”‚                        â”‚                   â”‚ IS MOBILE? YES     â”‚
    â”‚                        â”‚                   â”‚ EMPLOYEE? YES      â”‚
    â”‚                        â”‚                   â”‚ â”œâ†’ Create Attempt  â”‚
    â”‚                        â”‚                   â”‚ â”œâ†’ Create Alert    â”‚
    â”‚                        â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ INSERT
    â”‚                        â”‚                   â”‚ â”œâ†’ Return 403      â”‚
    â”‚                        â”‚ 403 + Message    â”‚                    â”‚
    â”‚                        â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚ "Mobile not allowed"   â”‚                   â”‚                    â”‚
    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                    â”‚
    â”‚                        â”‚                   â”‚                    â”‚
    â–¼                        â–¼                   â–¼                    â–¼

Admin View:
    â”‚
    â”‚ Bell Icon Lights Up (Notification)
    â”œâ”€â†’ Click Bell
    â”‚   â”œâ”€â†’ See: "Mobile login restricted"
    â”‚   â”œâ”€â†’ User: employee@example.com
    â”‚   â”œâ”€â†’ Device: Mobile Safari on iOS
    â”‚   â””â”€â†’ Time: Dec 11, 2025 3:45 PM
    â”‚
    â–¼

Result: Employee blocked from mobile access âœ“
```

## Session Validation Flow

```
User (Any Request After Login)

Device A (With Token)      Frontend           Auth Middleware        Database
    â”‚                         â”‚                    â”‚                    â”‚
    â”‚ Click "Dashboard"       â”‚                    â”‚                    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                    â”‚                    â”‚
    â”‚                         â”‚ + Bearer Token     â”‚                    â”‚
    â”‚                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                    â”‚
    â”‚                         â”‚                    â”‚ Validate Token Sig â”‚
    â”‚                         â”‚                    â”‚ â”œâ†’ Valid? NOâ†’401 âœ—  â”‚
    â”‚                         â”‚                    â”‚ â””â†’ Valid? YES      â”‚
    â”‚                         â”‚                    â”‚ Extract UserID     â”‚
    â”‚                         â”‚                    â”‚ Extract SessionID  â”‚
    â”‚                         â”‚                    â”‚ Find ActiveSession â”‚
    â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ SELECT
    â”‚                         â”‚                    â”‚â† Session record â”€â”€â”€â”‚
    â”‚                         â”‚                    â”‚ Check Status       â”‚
    â”‚                         â”‚                    â”‚ â”œâ†’ INVALIDATEDâ†’401 âœ—â”‚
    â”‚                         â”‚                    â”‚ â”œâ†’ EXPIREDâ†’401 âœ—    â”‚
    â”‚                         â”‚                    â”‚ â””â†’ ACTIVEâ†’Continue â”‚
    â”‚                         â”‚                    â”‚ Update Activity    â”‚
    â”‚                         â”‚                    â”‚ Time               â”‚
    â”‚                         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ UPDATE
    â”‚                         â”‚                    â”‚ â† Updated â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                         â”‚ 200 OK + Data     â”‚                    â”‚
    â”‚ Dashboard Loads        â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
    â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                    â”‚
    â”‚                         â”‚                    â”‚                    â”‚
    â–¼                         â–¼                    â–¼                    â–¼

Legend: â”œâ†’ Branch  â””â†’ Continue  âœ— Error
```

## Notification System Flow

```
Security Event                Admin Dashboard          Notification System
    â”‚                                â”‚                        â”‚
    â”‚ Mobile login attempt           â”‚                        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚                        â”‚
    â”‚ User: employee@example.com     â”‚                        â”‚
    â”‚ Device: iPhone (User-Agent)    â”‚                        â”‚
    â”‚ IP: 192.168.1.10               â”‚                        â”‚
    â”‚                                â”‚                        â”‚
    â”‚                                â”‚ Create Notification    â”‚
    â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                                â”‚ Type: MOBILE_LOGIN_RESTRICTED
    â”‚                                â”‚ Priority: HIGH         â”‚
    â”‚                                â”‚ RelatedData:           â”‚
    â”‚                                â”‚  - userEmail           â”‚
    â”‚                                â”‚  - deviceInfo          â”‚
    â”‚                                â”‚  - ipAddress           â”‚
    â”‚                                â”‚                        â”‚ INSERT INTO
    â”‚                                â”‚                        â”‚ notifications
    â”‚                                â”‚                        â”‚
    â”‚                                â”‚ Notification Created   â”‚
    â”‚                                â”‚                        â”‚
    â”‚ Socket.io Event                â”‚                        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Admin Page Updates     â”‚
    â”‚                                â”‚ - Bell icon lights up  â”‚
    â”‚                                â”‚ - Notification count   â”‚
    â”‚                                â”‚   increases            â”‚
    â”‚                                â”‚                        â”‚
    â”‚                                â”‚ Admin Clicks Bell      â”‚
    â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                                â”‚ GET /notifications     â”‚
    â”‚                                â”‚ â† List + unreadCount   â”‚
    â”‚                                â”‚                        â”‚
    â”‚                                â”‚ Admin Reads Notif      â”‚
    â”‚                                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                                â”‚ PUT /:id/read          â”‚
    â”‚                                â”‚ â† Updated              â”‚
    â”‚                                â”‚                        â”‚
    â–¼                                â–¼                        â–¼

Result: Admin informed of security event in real-time âœ“
```

## Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    App.tsx                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ State:                                              â”‚
â”‚ - currentUser                                       â”‚
â”‚ - sessionInfo                                       â”‚
â”‚ - notificationCenterOpen                            â”‚
â”‚ - sessionManagerOpen                                â”‚
â”‚                                                     â”‚
â”‚ Functions:                                          â”‚
â”‚ - handleLogin() â†’ Stores sessionInfo                â”‚
â”‚ - handleLogout() â†’ Clears sessionInfo               â”‚
â”‚                                                     â”‚
â”‚ Renders:                                            â”‚
â”‚ â”œâ”€ Sidebar                                          â”‚
â”‚ â”œâ”€ Header (with Notification Bell + Sessions)       â”‚
â”‚ â”œâ”€ Main Content (Dashboard, Tasks, etc)             â”‚
â”‚ â”œâ”€ TimeTracker (Employee/Leader only)               â”‚
â”‚ â”œâ”€ Chat Component                                   â”‚
â”‚ â”œâ”€ NotificationCenter (Conditional + Overlay)       â”‚
â”‚ â””â”€ SessionManager (Conditional + Overlay)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Sidebar â”‚  â”‚Notification     â”‚  â”‚SessionManagerâ”‚
    â”‚        â”‚  â”‚Center           â”‚  â”‚              â”‚
    â”‚- Nav   â”‚  â”‚                 â”‚  â”‚- Sessions    â”‚
    â”‚- User  â”‚  â”‚- Notifications  â”‚  â”‚- Device Info â”‚
    â”‚- Logoutâ”‚  â”‚- Mark Read      â”‚  â”‚- Logout Btn  â”‚
    â”‚        â”‚  â”‚- Delete         â”‚  â”‚- Activity    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Example: Complete Login Journey

```
Step 1: User Enters Credentials
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser     â”‚
â”‚ Form Input  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ email, password
       â–¼
Step 2: Frontend Sends Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App.tsx handleLogin()       â”‚
â”‚ axios.post('/api/auth/login')
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTP POST with credentials
       â–¼
Step 3: Backend Processes
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ server/routes/auth.js login endpoint   â”‚
â”‚ 1. Extract credentials                 â”‚
â”‚ 2. Get device info (UA, IP)            â”‚
â”‚ 3. Calculate fingerprint               â”‚
â”‚ 4. Validate password                   â”‚
â”‚ 5. Check mobile restriction            â”‚
â”‚ 6. Check existing sessions             â”‚
â”‚ 7. Create/update session               â”‚
â”‚ 8. Generate JWT                        â”‚
â”‚ 9. Return response                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ { token, sessionId, deviceInfo }
       â–¼
Step 4: Frontend Stores Session
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ localStorage.setItem('token')â”‚
â”‚ setSessionInfo()             â”‚
â”‚ setCurrentUser()             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
Step 5: User Sees Dashboard
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard rendered           â”‚
â”‚ Sessions button visible      â”‚
â”‚ Notification bell ready      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          DEVICE FINGERPRINTING                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  User-Agent String                              â”‚
â”‚  â†“                                              â”‚
â”‚  "Mozilla/5.0 (Windows NT 10.0; Win64; x64)... â”‚
â”‚                                                 â”‚
â”‚  + IP Address (from request header)             â”‚
â”‚  â†“                                              â”‚
â”‚  "203.0.113.42"                                 â”‚
â”‚                                                 â”‚
â”‚  Combine: UA + IP                               â”‚
â”‚  â†“                                              â”‚
â”‚  SHA-256 Hash                                   â”‚
â”‚  â†“                                              â”‚
â”‚  "abc123def456... (64 char hex string)"         â”‚
â”‚  â†“                                              â”‚
â”‚  Store as DeviceID in Database                  â”‚
â”‚                                                 â”‚
â”‚ Result: Unique, one-way identifier per device  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
âœ“ Can't be spoofed (hash is one-way)
âœ“ Can't be manipulated (server calculates it)
âœ“ Different per device (UA + IP combination)
âœ“ Auditable (stored in database)
```

---

**Diagram Types:**
- Architecture: System components and connections
- Sequence: Step-by-step process flows
- Flow: Decision branches and conditional paths
- Data: Information movement and transformation

**Last Updated:** December 11, 2025
